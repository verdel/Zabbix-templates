<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>5.0</version>
    <date>2020-07-30T13:40:45Z</date>
    <groups>
        <group>
            <name>Templates</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>Template Squid proxy with auth</template>
            <name>Template Squid proxy with auth</name>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>Authenticator</name>
                </application>
                <application>
                    <name>Client requests</name>
                </application>
                <application>
                    <name>Common</name>
                </application>
                <application>
                    <name>CPU</name>
                </application>
                <application>
                    <name>DNS</name>
                </application>
                <application>
                    <name>Network interfaces</name>
                </application>
                <application>
                    <name>Server requests</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>Squid service running</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>net.tcp.listen[3128]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <applications>
                        <application>
                            <name>Common</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}=0</expression>
                            <name>Squid service on {HOST.NAME} is not running</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Incoming network traffic on CIT uplink</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>network.INPUT_CIT</key>
                    <history>1w</history>
                    <units>Bps</units>
                    <applications>
                        <application>
                            <name>Network interfaces</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Incoming network traffic on RSNET uplink</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>network.INPUT_RSNET</key>
                    <history>1w</history>
                    <units>Bps</units>
                    <applications>
                        <application>
                            <name>Network interfaces</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Outgoing network traffic on CIT uplink</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>network.OUTPUT_CIT</key>
                    <history>1w</history>
                    <units>Bps</units>
                    <applications>
                        <application>
                            <name>Network interfaces</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Outgoing network traffic on RSNET uplink</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>network.OUTPUT_RSNET</key>
                    <history>1w</history>
                    <units>Bps</units>
                    <applications>
                        <application>
                            <name>Network interfaces</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Squid service CPU usage</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>proc.cpu.util[squid]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>CPU</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{avg(3m)}&gt;{$CPU_PROCENT_WARN}</expression>
                            <name>CPU usage of Squid service is too high</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Current percentage of active $1 processes</name>
                    <type>CALCULATED</type>
                    <key>squid.Authenticator.active.percentage[basicauthenticator]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <params>100*last(&quot;squid.Authenticator.active[basicauthenticator]&quot;)/last(&quot;squid.Authenticator.max[basicauthenticator]&quot;)</params>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{avg(3m)}&gt;{$AUTHENTICATOR_PROCENT_WARN}</expression>
                            <name>Basic authenticator process usage of Squid service is too high</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Current percentage of active $1 processes</name>
                    <type>CALCULATED</type>
                    <key>squid.Authenticator.active.percentage[negotiateauthenticator]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <params>100*last(&quot;squid.Authenticator.active[negotiateauthenticator]&quot;)/last(&quot;squid.Authenticator.max[negotiateauthenticator]&quot;)</params>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{avg(3m)}&gt;{$AUTHENTICATOR_PROCENT_WARN}</expression>
                            <name>Negotiate authenticator process usage of Squid service is too high</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Current percentage of active $1 processes</name>
                    <type>CALCULATED</type>
                    <key>squid.Authenticator.active.percentage[ntlmauthenticator]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <params>100*last(&quot;squid.Authenticator.active[ntlmauthenticator]&quot;)/last(&quot;squid.Authenticator.max[ntlmauthenticator]&quot;)</params>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{avg(3m)}&gt;{$AUTHENTICATOR_PROCENT_WARN}</expression>
                            <name>NTLM authenticator process usage of Squid service is too high</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Number of $1 authenticator process currently active</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.Authenticator.active[basicauthenticator]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{avg(3m)}&lt;{$BASIC_AUTHENTICATOR_NUMBER_WARN}</expression>
                            <name>Number of Basic authenticator process is too low</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Number of $1 authenticator process currently active</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.Authenticator.active[negotiateauthenticator]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{avg(3m)}&lt;{$NEGOTIATE_AUTHENTICATOR_NUMBER_WARN}</expression>
                            <name>Number of Negotiate authenticator process is too low</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Number of $1 authenticator process currently active</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.Authenticator.active[ntlmauthenticator]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{avg(3m)}&lt;{$NTLM_AUTHENTICATOR_NUMBER_WARN}</expression>
                            <name>Number of NTLM authenticator process is too low</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Average requests service time of $1 authenticator process</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.Authenticator.avgservicetime[basicauthenticator]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>0.001</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{avg(3m)}&gt;{$AUTHENTICATOR_AVERAGE_SERVICE_TIME_WARN}</expression>
                            <name>Average request service time for Basic authenticator process is too high</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Average requests service time of $1 authenticator process</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.Authenticator.avgservicetime[negotiateauthenticator]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>0.001</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{avg(3m)}&gt;{$AUTHENTICATOR_AVERAGE_SERVICE_TIME_WARN}</expression>
                            <name>Average request service time for Negotiate authenticator process is too high</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Average requests service time of $1 authenticator process</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.Authenticator.avgservicetime[ntlmauthenticator]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>0.001</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{avg(3m)}&gt;{$AUTHENTICATOR_AVERAGE_SERVICE_TIME_WARN}</expression>
                            <name>Average request service time for NTLM authenticator process is too high</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Max number of $1 authenticator process set for Squid</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.Authenticator.max[basicauthenticator]</key>
                    <delay>300s</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Max number of $1 authenticator process set for Squid</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.Authenticator.max[negotiateauthenticator]</key>
                    <delay>300s</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Max number of $1 authenticator process set for Squid</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.Authenticator.max[ntlmauthenticator]</key>
                    <delay>300s</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Queue length of $1 authenticator process</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.Authenticator.queue[basicauthenticator]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{avg(3m)}&gt;{$AUTHENTICATOR_QUEUE_WARN}</expression>
                            <name>Queue length of Basic authenticator process is too long</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Queue length of $1 authenticator process</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.Authenticator.queue[negotiateauthenticator]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{avg(3m)}&gt;{$AUTHENTICATOR_QUEUE_WARN}</expression>
                            <name>Queue length of Negotiate authenticator process is too long</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Queue length of $1 authenticator process</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.Authenticator.queue[ntlmauthenticator]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{avg(3m)}&gt;{$AUTHENTICATOR_QUEUE_WARN}</expression>
                            <name>Queue length of NTLM authenticator process is too long</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Number of responses received by the $1 authenticator process/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.Authenticator.replies[basicauthenticator]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Number of responses received by the $1 authenticator process/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.Authenticator.replies[negotiateauthenticator]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Number of responses received by the $1 authenticator process/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.Authenticator.replies[ntlmauthenticator]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Number of requests processed by the $1 authenticator process/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.Authenticator.requests[basicauthenticator]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Number of requests processed by the $1 authenticator process/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.Authenticator.requests[negotiateauthenticator]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Number of requests processed by the $1 authenticator process/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.Authenticator.requests[ntlmauthenticator]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Number of unreplied requests processed by the $1 process/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.Authenticator.unreplied[basicauthenticator]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{avg(3m)}&gt;{$AUTHENTICATOR_UNSUCCESSFUL_WARN}</expression>
                            <name>Number of unreplied request for Basic authenticator process is too high</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Number of unreplied requests processed by the $1 process/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.Authenticator.unreplied[negotiateauthenticator]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{avg(3m)}&gt;{$AUTHENTICATOR_UNSUCCESSFUL_WARN}</expression>
                            <name>Number of unreplied request for Negotiate authenticator process is too high</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Number of unreplied requests processed by the $1 process/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.Authenticator.unreplied[ntlmauthenticator]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{avg(3m)}&gt;{$AUTHENTICATOR_UNSUCCESSFUL_WARN}</expression>
                            <name>Number of unreplied request for NTLM authenticator process is too high</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Error clients HTTP requests/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.ClientHttpError</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Client requests</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Success clients HTTP requests/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.ClientHttpRequest</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Client requests</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Traffic from clients B/s</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.ClientKbytesIn</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>Bps</units>
                    <applications>
                        <application>
                            <name>Client requests</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1024</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Traffic to clients B/s</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.ClientKbytesOut</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>Bps</units>
                    <applications>
                        <application>
                            <name>Client requests</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1024</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Squid number of current active connections</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.ConAct</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <applications>
                        <application>
                            <name>Common</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{avg(3m)}&lt;{$CLIENT_NUMBER_WARN} and {time()}&gt;={$ENABLED_TIME_START} and {time()}&lt;={$ENABLED_TIME_STOP} and {dayofweek()}&lt;6</expression>
                            <name>Client connections numbers of Squid service is too low</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Squid number of current unique active client</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.ConActUniq</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <applications>
                        <application>
                            <name>Common</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Median DNS requests service time for 5min</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.DnsMedianSvc5min</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <applications>
                        <application>
                            <name>Client requests</name>
                        </application>
                        <application>
                            <name>DNS</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&gt;{$DNS_SERVICE_TIME_WARN}</expression>
                            <name>Average DNS request service time is too high</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Median DNS requests service time for 60min</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.DnsMedianSvc60min</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <applications>
                        <application>
                            <name>Client requests</name>
                        </application>
                        <application>
                            <name>DNS</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Number of DNS requests to $1/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.DnsRequests[10.33.64.20]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>DNS</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Number of DNS requests to $1/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.DnsRequests[10.33.64.21]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>DNS</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Number of DNS requests to $1/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.DnsRequests[127.0.0.1]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>DNS</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Number of unsuccess DNS requests to $1/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.DnsUnsuccessRequests[10.33.64.20]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>DNS</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{avg(3m)}&gt;{$DNS_UNSUCCESSFUL_WARN}</expression>
                            <name>Number of unreplied DNS request for 10.33.64.20 is too high</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Number of unsuccess DNS requests to $1/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.DnsUnsuccessRequests[10.33.64.21]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>DNS</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{avg(3m)}&gt;{$DNS_UNSUCCESSFUL_WARN}</expression>
                            <name>Number of unreplied DNS request for 10.33.64.21 is too high</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Number of unsuccess DNS requests to $1/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.DnsUnsuccessRequests[127.0.0.1]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>DNS</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                </item>
                <item>
                    <name>Number of file descriptors currently in use by Squid service</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.Filedesc.current</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <applications>
                        <application>
                            <name>Common</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Number of file descriptors currently in use by Squid service (percentage)</name>
                    <type>CALCULATED</type>
                    <key>squid.Filedesc.current.percentage</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <params>100*last(&quot;squid.Filedesc.current&quot;)/last(&quot;squid.Filedesc.max&quot;)</params>
                    <applications>
                        <application>
                            <name>Common</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{avg(3m)}&gt;{$FD_PROCENT_WARN}</expression>
                            <name>File descriptors usage of Squid service is too high</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Max number of file descriptors set for the Squid service</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.Filedesc.max</key>
                    <delay>300s</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <applications>
                        <application>
                            <name>Common</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Median HTTP requests service time for 5min</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.HttpMedianSvc5min</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <applications>
                        <application>
                            <name>Client requests</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{last(0)}&gt;{$REQUEST_SERVICE_TIME_WARN}</expression>
                            <name>Average HTTP request service time is too high</name>
                            <priority>WARNING</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Median HTTP requests service time for 60min</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.HttpMedianSvc60min</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>s</units>
                    <applications>
                        <application>
                            <name>Client requests</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Error server ALL requests/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.ServerAllError</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Server requests</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Success server ALL requests/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.ServerAllRequest</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Server requests</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Error server FTP requests/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.ServerFtpError</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Server requests</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Success server FTP requests/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.ServerFtpRequest</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Server requests</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Error server HTTP requests/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.ServerHttpError</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Server requests</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Success server HTTP requests/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.ServerHttpRequest</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Server requests</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Traffic from servers B/s</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.ServerKbytesIn</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>Bps</units>
                    <applications>
                        <application>
                            <name>Server requests</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1024</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Traffic to servers B/s</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.ServerKbytesOut</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <units>Bps</units>
                    <applications>
                        <application>
                            <name>Server requests</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                        <step>
                            <type>MULTIPLIER</type>
                            <params>1024</params>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Error server Other requests/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.ServerOtherError</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Server requests</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Success server Other requests/sec</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.ServerOtherRequest</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <value_type>FLOAT</value_type>
                    <applications>
                        <application>
                            <name>Server requests</name>
                        </application>
                    </applications>
                    <preprocessing>
                        <step>
                            <type>CHANGE_PER_SECOND</type>
                            <params/>
                        </step>
                    </preprocessing>
                    <request_method>POST</request_method>
                </item>
                <item>
                    <name>Squid service uptime</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>squid.Uptime</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <units>uptime</units>
                    <applications>
                        <application>
                            <name>Common</name>
                        </application>
                    </applications>
                    <request_method>POST</request_method>
                    <triggers>
                        <trigger>
                            <expression>{change(0)}=0</expression>
                            <name>Squid on {HOST.NAME} has just been restarted</name>
                            <priority>INFO</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Busy status of $4</name>
                    <type>EXTERNAL</type>
                    <key>squid_check_busy_process.py[--squid-host,{HOST.CONN},--type,basicauthenticator]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{min(3m)}=1</expression>
                            <name>One of the Basic authenticator is busy for too long</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Busy status of $4</name>
                    <type>EXTERNAL</type>
                    <key>squid_check_busy_process.py[--squid-host,{HOST.CONN},--type,external_acl]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{min(3m)}=1</expression>
                            <name>One of the External_ACL authenticator is busy for too long</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Busy status of $4</name>
                    <type>EXTERNAL</type>
                    <key>squid_check_busy_process.py[--squid-host,{HOST.CONN},--type,negotiateauthenticator]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{min(3m)}=1</expression>
                            <name>One of the Negotiate authenticator is busy for too long</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <name>Busy status of $4</name>
                    <type>EXTERNAL</type>
                    <key>squid_check_busy_process.py[--squid-host,{HOST.CONN},--type,ntlmauthenticator]</key>
                    <delay>60s</delay>
                    <history>30d</history>
                    <trends>90d</trends>
                    <applications>
                        <application>
                            <name>Authenticator</name>
                        </application>
                    </applications>
                    <triggers>
                        <trigger>
                            <expression>{min(3m)}=1</expression>
                            <name>One of the NTLM authenticator is busy for too long</name>
                            <priority>AVERAGE</priority>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <macros>
                <macro>
                    <macro>{$AUTHENTICATOR_AVERAGE_SERVICE_TIME_WARN}</macro>
                    <value>0.1</value>
                </macro>
                <macro>
                    <macro>{$AUTHENTICATOR_PROCENT_WARN}</macro>
                    <value>70</value>
                </macro>
                <macro>
                    <macro>{$AUTHENTICATOR_QUEUE_WARN}</macro>
                    <value>10</value>
                </macro>
                <macro>
                    <macro>{$AUTHENTICATOR_UNSUCCESSFUL_WARN}</macro>
                    <value>10</value>
                </macro>
                <macro>
                    <macro>{$BASIC_AUTHENTICATOR_NUMBER_WARN}</macro>
                    <value>0</value>
                </macro>
                <macro>
                    <macro>{$CLIENT_NUMBER_WARN}</macro>
                    <value>10</value>
                </macro>
                <macro>
                    <macro>{$CPU_PROCENT_WARN}</macro>
                    <value>100</value>
                </macro>
                <macro>
                    <macro>{$DNS_SERVICE_TIME_WARN}</macro>
                    <value>0.1</value>
                </macro>
                <macro>
                    <macro>{$DNS_UNSUCCESSFUL_WARN}</macro>
                    <value>10</value>
                </macro>
                <macro>
                    <macro>{$ENABLED_TIME_START}</macro>
                    <value>084500</value>
                </macro>
                <macro>
                    <macro>{$ENABLED_TIME_STOP}</macro>
                    <value>190000</value>
                </macro>
                <macro>
                    <macro>{$FD_PROCENT_WARN}</macro>
                    <value>70</value>
                </macro>
                <macro>
                    <macro>{$NEGOTIATE_AUTHENTICATOR_NUMBER_WARN}</macro>
                    <value>1</value>
                </macro>
                <macro>
                    <macro>{$NTLM_AUTHENTICATOR_NUMBER_WARN}</macro>
                    <value>1</value>
                </macro>
                <macro>
                    <macro>{$REQUEST_SERVICE_TIME_WARN}</macro>
                    <value>3</value>
                </macro>
            </macros>
        </template>
    </templates>
</zabbix_export>
